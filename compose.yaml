services:
  predictum:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "5173:5173"   # Frontend
      - "8080:8080"   # Linera faucet
      - "9001:9001"   # Linera validator proxy
      - "3001:3001"   # Go backend API
    volumes:
      - .:/build
      - linera-data:/root/.local/share/linera
    environment:
      - LINERA_WALLET_DIR=/root/.local/share/linera
      - LINERA_STORAGE=memory
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3001/api/balance"]
      interval: 10s
      timeout: 3s
      retries: 3
      start_period: 30s
    networks:
      - predictum-network

volumes:
  linera-data:
    driver: local

networks:
  predictum-network:
    driver: bridge

